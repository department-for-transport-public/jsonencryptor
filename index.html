<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Secure Encryption of json service token keys • jsonencryptor</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Secure Encryption of json service token keys">
<meta name="description" content="Uses the sodium package to encrypt json keys for use locally and in rsconnect">
<meta property="og:description" content="Uses the sodium package to encrypt json keys for use locally and in rsconnect">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">jsonencryptor</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/using_jsonencryptor_for_gcp.html">using_jsonencryptor_for_gcp</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><p>The jsonencryptor package is designed to encrypt JSON service account keys using the secure sodium encryption package. This makes them secure to use both locally and as part of the rsconnect Shiny hosting platform.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>To install this package directly from github run:</p>
<p><code>remotes::install_github("department-for-transport-public/jsonencryptor")</code></p>
</div>
<div class="section level2">
<h2 id="generating-a-secure-password">Generating a secure password<a class="anchor" aria-label="anchor" href="#generating-a-secure-password"></a>
</h2>
<p>You can either create your own password or get the package to generate it for you, using the <code><a href="reference/secret_pw_gen.html">secret_pw_gen()</a></code> function.</p>
<p>To use the password during development in Cloud R and to use it to encrypt a json file, assign it to a local variable with <code>Sys.setenv("GARGLE_PASSWORD" = your_password)</code>. To use it in rsconnect, navigate to a dashboard you have publisher permissions for, and select the <em>vars</em> tab. Create a new variable with the <em>name</em> GARGLE_PASSWORD and a <em>value</em> of your password, making sure you don’t use quotation marks for either.</p>
<div class="float">
<img src="https://user-images.githubusercontent.com/84339173/228290578-c89e3d95-25e3-458a-a157-f1f2234991a6.png" alt="image"><div class="figcaption">image</div>
</div>
</div>
<div class="section level2">
<h2 id="encrypting-a-json-key-with-your-password">Encrypting a json key with your password<a class="anchor" aria-label="anchor" href="#encrypting-a-json-key-with-your-password"></a>
</h2>
<p>Once you have generated your password and saved it as a local variable, you can encrypt a saved json service key token.</p>
<p>Use the <code><a href="reference/secret_write.html">secret_write()</a></code> function to do this, passing it three arguments:</p>
<ul>
<li>The <em>name</em> of the encrypted output file. This function will always save it in a folder called inst/secret.</li>
<li>The filepath of the <em>input</em> unencrypted json file.</li>
<li>(Optional) the <em>dir</em> (directory) you want to write out to. By default this will be your working directory, but you can change this particularly for working with shiny apps (which have a working directory inside their folder structure).</li>
</ul>
<p>This service key token is fully encrypted and you are fine to treat it like any other text object (e.g. you can upload this to Github and publish to rsconnect).</p>
</div>
<div class="section level2">
<h2 id="unencrypting-your-json-key-to-use-it">Unencrypting your json key to use it<a class="anchor" aria-label="anchor" href="#unencrypting-your-json-key-to-use-it"></a>
</h2>
<p>To unencrypt your json key, use the <code><a href="reference/secret_read.html">secret_read()</a></code> function, passing it the file name of your encrypted json key inside the inst/secret folder. This function can be used directly inside the gargle function to authenticate access to big query e.g.:</p>
<p><code>bq_auth(path = secret_read("my_access_token.json"))</code></p>
<p>or in the similar googleCloudStorageR function to authenticate access to GCS:</p>
<p><code>gcs_auth(secret_read("my_access_token.json"))</code></p>
<p>Both locally and on rsconnect you will need to have set your password variable before this will work.</p>
</div>

  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing jsonencryptor</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Francesca Bryden <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Francesca Bryden.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
